<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>テキスト保存＆リンク起動PWA</title>
  <meta name="theme-color" content="#0b1020" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="apple-touch-icon" href="./assets/icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <style>
    :root { color-scheme: light dark; }
    *{box-sizing:border-box}
    html,body{margin:0;background:#0b1020;color:#e5e7eb;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif}
    .wrap{max-width:960px;margin:0 auto;padding:16px 16px 96px}
    h1{font-size:18px;margin:12px 0 8px;font-weight:700}
    .card{background:#0f172a;border:1px solid #23324d;border-radius:16px;padding:12px}
    textarea{
      width:100%;min-height:140px;border:1px solid #2b3b5a;border-radius:12px;
      background:#0b1222;color:#e5e7eb;padding:12px;outline:none;resize:vertical;font-size:16px !important;
    }
    .row{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    .btn{
      appearance:none;border:1px solid #263755;background:#16233d;color:#e5e7eb;
      padding:12px 14px;border-radius:12px;cursor:pointer;font-weight:600;font-size:15px;
      transition:transform .02s ease,opacity .2s ease;user-select:none
    }
    .btn:active{transform:scale(.98)}
    .btn.copy{background:#1e3a8a;border-color:#3655a8}
    .grid{
      display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px
    }
    @media (min-width:560px){ .grid{grid-template-columns:repeat(3,1fr)} }
    @media (min-width:840px){ .grid{grid-template-columns:repeat(4,1fr)} }
    .linkbtn{
      display:block;text-align:center;text-decoration:none;color:#e5e7eb;background:#17253f;
      border:1px solid #2a3e62;border-radius:14px;padding:16px;min-height:64px;
      font-weight:700;line-height:1.2;word-break:break-word
    }
    .hint{opacity:.7;font-size:12px;margin-top:6px}
    /* トースト */
    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:#111827;color:#e5e7eb;border:1px solid #374151;
      padding:10px 14px;border-radius:999px;opacity:0;pointer-events:none;transition:opacity .2s ease
    }
    .toast.show{opacity:1}
    /* 安全領域 */
    @supports (padding: max(0px)) {
      .wrap{padding-bottom: max(96px, env(safe-area-inset-bottom))}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>メモ（自動保存・ワンタップコピー）</h1>
    <div class="card">
      <textarea id="memo" placeholder="ここにテキストを入力…（入力と同時に自動保存されます）"></textarea>
      <div class="row">
        <button id="copyBtn" class="btn copy">このテキストをコピー</button>
        <button id="clearBtn" class="btn" title="内容を消去してもストレージは残ります">消去</button>
      </div>
      <div class="hint">
        URLパラメータで初期文を設定する例：<code>?text=初期テキスト</code>
      </div>
    </div>

    <h1>リンク起動（URLパラメータで定義可）</h1>
    <div id="links" class="grid">
      <!-- app.js で生成 -->
    </div>
    <div class="card hint">
      例）<code>?btn=X|https://46memorybit.github.io/SNSPWA/X/index.html&amp;btn=歌ネット|https://www.uta-net.com/song/382246/&amp;btn=USEN|https://usen.oshireq.com/song/6299592</code><br/>
      <small>※ <strong>btn=タイトル|URL</strong> を繰り返し指定。<code>|</code>は区切りです。</small>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="./db.js"></script>
  <script src="./app.js"></script>
  <script>
    // PWA Service Worker 登録
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
